<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://assets.zendesk.com/apps/sdk-assets/css/2/zendesk_garden.css" type="text/css">
  </head>
  <body>
    <div id="container">
      <iframe src="" id="iframeURL" width="300" height="800" frameborder="0" style="border:0" allowfullscreen></iframe>
    </div>
    <script type="text/javascript" src="https://static.zdassets.com/zendesk_app_framework_sdk/2.0/zaf_sdk.min.js"></script>
    <script>
      var client = ZAFClient.init();
      var URL_Final = "https://www.zendesk.com.br";
      client.invoke('resize', {height: '800px' });
      
      console.log('--------------------------------------------------------------------------------');

      client.get('ticket.id').then(function(data) {
        console.log('--------------------------------------------------------------------------------');
        console.log('--------------------------------------------------------------------------------');
        console.log('--------------------------------------------------------------------------------');
        console.log('----------------------------------DATA------------------------------------------');
        console.log(data);
        var TicketId = data['ticket.id'];
        console.log('--------------------------------------------------------------------------------');
        console.log('--------------------------------------------------------------------------------');
        console.log('--------------------------------------------------------------------------------');
        console.log('--------------------------------TicketId----------------------------------------');
        console.log(TicketId);

        client.metadata().then(function(metadata) {
          console.log('--------------------------------------------------------------------------------');
          console.log('--------------------------------------------------------------------------------');
          console.log('--------------------------------------------------------------------------------');
          console.log('-----------------------------metadata.settings----------------------------------');
          console.log(metadata.settings);
          var URL_Angular = metadata.settings.Site;
          console.log('--------------------------------------------------------------------------------');
          console.log('--------------------------------------------------------------------------------');
          console.log('--------------------------------------------------------------------------------');
          console.log('--------------------------------URL_Angular-------------------------------------');
          console.log(URL_Angular);


          URL_Final = URL_Angular + '?id=' + TicketId;
          console.log('--------------------------------------------------------------------------------');
          console.log('--------------------------------------------------------------------------------');
          console.log('--------------------------------------------------------------------------------');
          console.log('---------------------------------URL_Final--------------------------------------');
          console.log(URL_Final);

          document.getElementById("iframeURL").src = URL_Final;


        });


      });

      console.log('Testando: '+URL_Final);


    </script>
  </body>
</html>
